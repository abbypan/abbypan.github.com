---
layout: post
category: tech
title:  "TLS, DTLS"
tagline: ""
tags: [ "tls" ] 
---
{% include JB/setup %}

* TOC
{:toc}

# doc

[SMTP and Transport Layer Security (TLS)](https://www.fehcom.de/qmail/smtptls.html)

[TLSeminar](https://tlseminar.github.io/)

[More Privacy, Less Latency tls1.3](https://timtaubert.de/blog/2015/11/more-privacy-less-latency-improved-handshakes-in-tls-13/)

[RFC 8446: tls 1.3](https://tools.ietf.org/html/rfc8446)

[ A Readable Specification of TLS 1.3 ](https://davidwong.fr/tls13/)

# nonce

[TLS nonce-nse](https://blog.cloudflare.com/tls-nonce-nse/)

tls 1.2  nonce = 显式的固定IV + SEQNUM

tls 1.3  nonce = 派生的固定IV xor  SEQNUM

# tls-psk

[On the Security of the Pre-Shared Key Ciphersuites of TLS](https://www.iacr.org/archive/pkc2014/83830158/83830158.pdf)


# 案例

## CBC Padding Oracle Attack

[BEAST vs. CRIME Attack](https://resources.infosecinstitute.com/beast-vs-crime-attack/)

BEAST & Lucky 13 & POODLE

Web场景禁用cbc的ciphersuite

##  Diffie-Hellman实际强度

Logjam (MITM) => TLS1.3

DH 参数强度 => 优先选用ECDH

Bleichenbacher attack/DROWN attack => 禁用RSA PKCS#1 V1.5 PADDING，使用RSA OAEP PADDING

## SLtrip Attack(MITM)

HSTS登记网站

Browser配合

## 编码实现

Heartbleed => 参数检查

CRIME => tls compression算法禁止选择deflate

## nonce misuse

[Nonce-Disrespecting Adversaries: PracticalForgery Attacks on GCM in TLS](https://eprint.iacr.org/2016/475.pdf)

避免gcm的错误实现引入漏洞

要么像 chacha20-poly1305，aes-ocb一样，基于seq number & key 生成nonce

要么像 aes-siv 之类，实现类似 mac-then-encrypt的机制，生成tag & nonce



