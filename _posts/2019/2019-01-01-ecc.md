---
layout: post
category: tech
title:  "ecc"
tagline: ""
tags: [ "ecc", "ecies" ] 
---
{% include JB/setup %}

* TOC
{:toc}

# basic

[Technical Guideline TR-03111 Elliptic Curve Cryptography](https://www.bsi.bund.de/SharedDocs/Downloads/EN/BSI/Publications/TechGuidelines/TR03111/BSI-TR-03111_V-2-0_pdf.pdf?__blob=publicationFile&v=2)

[SafeCurves: choosing safe curves for elliptic-curve cryptography](https://safecurves.cr.yp.to/index.html)

[Elliptic Curve Cryptography: ECDH and ECDSA](https://andrea.corbellini.name/2015/05/30/elliptic-curve-cryptography-ecdh-and-ecdsa/)

[Cryptography - The ElGamal Public key System (Public key encryption from Diffie Hellman)](https://www.youtube.com/watch?v=fUSN7z0UquU)

[Elliptic Curve Public Key Cryptography](http://gauss.ececs.uc.edu/Courses/c653/lectures/PDF/elliptic.pdf)

[CPSC 467:  Cryptography and Computer Security](https://zoo.cs.yale.edu/classes/cs467/2017f/lectures/ln13.pdf)

[Elliptic Curves](https://crypto.stanford.edu/pbc/notes/elliptic/)

# Elliptic Curve Integrated Encryption Scheme (ECIES)

[A Survey of the Elliptic Curve Integrated Encryption Scheme](https://pdfs.semanticscholar.org/9f5e/ec8cb6a8883498157e8e27723da52ae4c752.pdf)

[Integrated Encryption Scheme](https://en.wikipedia.org/wiki/Integrated_Encryption_Scheme)

[Elliptic Curve Integrated Encryption Scheme (ECIES)](https://www.youtube.com/watch?v=saZj0ZKRNl0)

[A Comparison of the Standardized Versions of ECIES](http://citeseerx.ist.psu.edu/viewdoc/download?doi=10.1.1.819.9345&rep=rep1&type=pdf)

[libsodium doc](https://download.libsodium.org/doc/)

[ECC Encryption / Decryption](https://cryptobook.nakov.com/asymmetric-key-ciphers/ecc-encryption-decryption)

[Crypto In Action](https://github.com/longcpp/CryptoInAction)

使用KA(key agreement)协商一个密钥S，使用KDF基于S生成会话密钥，其实基本上就是ECDH。

会话密钥用于ENC对称加密，同时还有MAC函数, HASH函数。

因此plaintext长度基本不受限。

实例见 [eciespy](https://pypi.org/project/eciespy/)

# ec elgamal

[el gamal encryption](https://www.youtube.com/watch?v=pyirxbHuvOw)

[Elgamal Encryption using Elliptic Curve Cryptography](https://cse.unl.edu/~ssamal/crypto/EEECC.pdf)

相当于在ec上的elgamal，此时plaintext长度受限于group size。与rsa类似，计算时要mod N。

实例见 [Crypt::PK::ECC](https://metacpan.org/pod/Crypt::PK::ECC)

# ec point

[Elliptic Curves](https://www.cs.purdue.edu/homes/ssw/cs655/ec.pdf)

如果是ec point变换，则受限于ec point的个数。本原根。

# pairing

[PBC Library](https://crypto.stanford.edu/pbc/)

# ecdsa

[ECDSA Malleability](http://coders-errand.com/malleability-ecdsa-signatures/)

[The Exact Security of ECDSA](http://cacr.uwaterloo.ca/techreports/2000/corr2000-54.ps)

[Elliptic Curve Cryptography: ECDH and ECDSA](https://andrea.corbellini.name/2015/05/30/elliptic-curve-cryptography-ecdh-and-ecdsa/)

[How Not to Use ECDSA](https://yondon.blog/2019/01/01/how-not-to-use-ecdsa/)

## malleability

(r, s) , (r, -s) 均可校验成功，签名构造。

low-s value 可修复该漏洞。

## Verification Without Hash Pre-Image

可根据public key 任意构造(r, s, h)

因此，校验必须带原message，而非只校验h=hash(message)

## RFC6979: Deterministic Usage of the Digital Signature Algorithm (DSA) and Elliptic Curve Digital Signature Algorithm (ECDSA)

sony ps3 的案例是没有按算法要求生成随机数k。

RFC6979 的处理是，用SP800-90A的`HMAC_DRBG`随机数生成器生成k，其中，熵值用私钥(x)，nonce用hash(message)。

EdDSA的做法类似RFC6979。
