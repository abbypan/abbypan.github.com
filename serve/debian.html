
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Debian 安装笔记</title>
    <meta name="description" content="">
    <meta name="author" content="Pan Lanlan">

    <!-- Enable responsive viewport -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le styles -->
    <link href="/assets/themes/twitter/bootstrap/css/bootstrap.2.2.2.min.css" rel="stylesheet">
    <link href="/assets/themes/twitter/css/style.css?body=1" rel="stylesheet" type="text/css" media="all">

    <!-- Le fav and touch icons -->
  <!-- Update these with your own images
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
  -->

    <!-- atom & rss feed -->
    <link href="/atom.xml" type="application/atom+xml" rel="alternate" title="Sitewide ATOM Feed">
    <link href="/rss.xml" type="application/rss+xml" rel="alternate" title="Sitewide RSS Feed">

  </head>

  <body>
    <div class="navbar">
      <div class="navbar-inner">
        <div class="container-narrow">
          <a class="brand" href="/">江天一色</a>
          <ul class="nav">
            
            
            


  
    
      
    
  
    
      
      	
      	<li><a href="/categories.html">Categories</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/tags.html">Tags</a></li>
      	
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/archive.html">Archive</a></li>
      	
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
    
  
    
      
      	
      	<li><a href="/pages.html">Pages</a></li>
      	
      
    
  



          </ul>
        </div>
      </div>
    </div>

    <div class="container-narrow">

      <div class="content">
        
<div class="page-header">
  <h1>Debian 安装笔记 </h1>
</div>

<div class="row-fluid">
  <div class="span12">
    <h2 id='id34'>安装</h2>

<h3 id='apt'>设置apt源</h3>

<ul>
<li>
<p>BIOS里选网络启动，重启，选debian网络安装；</p>
</li>

<li>
<p>网络启动介绍见<a href='http://pxe.ustc.edu.cn'>PXE.USTC 基本文档</a></p>
</li>

<li>
<p>也可以参考<a href='http://mail.ustc.edu.cn/~lixuebai/GNU/DebianInstall.html'>硬盘安装说明 by lixuebai@ustc</a></p>
</li>

<li>
<p>手动输入源：__debian.ustc.edu.cn__；</p>
</li>

<li>
<p>/etc/apt/source.list</p>

<ul>
<li>ftp://debian.ustc.edu.cn/sources.list/</li>

<li><code>deb ftp://202.38.73.198/debian sid foo</code></li>
</ul>
</li>
</ul>

<h3 id='etcenvironment'>/etc/environment</h3>

<pre><code>LANG=&quot;zh_CN.UTF-8&quot;
LANGUAGE=&quot;zh_CN:zh&quot;</code></pre>

<h3 id='etcfstab'>/etc/fstab</h3>

<pre><code>/dev/sda1 /mnt/usb vfat user,rw,noauto,utf8=1,fmask=113,dmask=022,umask=022 0 0</code></pre>

<h3 id='id35'>基础包</h3>

<ul>
<li>apt-get install build-essential</li>
</ul>

<h2 id='id36'>网络</h2>

<h3 id='adsl'>adsl</h3>

<ul>
<li>主要参考这两个贴子：<a href='http://linux.hiweed.com/node/2467'>adsl by Fly1945@Hiweed</a>，<a href='http://ryang.68ab.com/debian.html#sec8'>adsl配置 by ryang</a></li>

<li>apt-get install pppoe</li>

<li>将/etc/network/interfaces中的相关内容注释掉</li>

<li>/etc/ppp/peers/dsl-provider</li>
</ul>

<blockquote>
<p>noipdefault usepeerdns defaultroute hide-password lcp-echo-interval 20 lcp-echo-failure 3 connect /bin/true noauth persist mtu 1492 noaccomp default-asyncmap plugin rp-pppoe.so eth0</p>

<h1 id='xxxadsl'>下边的xxx是adsl拨号时使用的用户名</h1>

<p>user &#8220;xxx&#8221;</p>
</blockquote>

<ul>
<li>/etc/ppp/pap-secrets</li>
</ul>

<blockquote>
<h1 id='xxxadslyyy'>下边的xxx是adsl拨号时使用的用户名，yyy是密码</h1>
</blockquote>

<p>&#8220;xxx&#8221; dsl-provider &#8220;yyy&#8221; *</p>

<ul>
<li>pon dsl-provider</li>

<li>查错：plog</li>
</ul>

<h3 id='vpn'>vpn</h3>

<p>- 主要参考这几个贴子 - <a href='http://bbs.ustc.edu.cn/cgi/bbscon?bn=Linux&amp;fn=M3F936B98&amp;num=2136'>VPN连接校园网 by kkk@ustc</a> - <a href='http://bbs.ustc.edu.cn/cgi/bbscon?bn=Linux&amp;fn=M454D58AB&amp;num=2351'>pptp-linux拨vpn by hacker ustc</a> - <a href='http://pptpclient.sourceforge.net/howto-debian.phtml'>PPTP CLient by James Cameron</a> - <a href='http://bbs.ustc.edu.cn/cgi/bbstcon?board=Script&amp;file=M.1211129882.A'>发一个让校内ip走vpn路由的perl脚本吧</a></p>

<ul>
<li>apt-get install pptp-linux</li>

<li>设vpn连接名为$tunnel，连接的目标主机地址为$vpn_ip，用户名为$user，密码为$password</li>

<li>/etc/ppp/options.pptp</li>
</ul>

<blockquote>
<p>lock noauth nobsdcomp nodeflate nopcomp noaccomp noproxyarp</p>
</blockquote>

<ul>
<li>/etc/ppp/peers/$tunnel</li>
</ul>

<blockquote>
<p>pty &#8220;pptp $vpn_ip &#8211;nolaunchpppd&#8221; name $user remotename $tunnel file /etc/ppp/options.pptp ipparam $tunnel noauth persist linkname $tunnel nodefaultroute</p>
</blockquote>

<ul>
<li>
<p>/etc/ppp/chap-secrets</p>

<p><code>$user $tunnel $password *</code></p>
</li>

<li>
<p>pon $tunnel debug dump logfd 2 nodetach</p>
</li>

<li>
<p>ifconfig查看ppp0的网关的ip为$vpn_gateway，之前的默认网关ip设为$gateway，如果网关经常变就在下面的脚本中搞成动态获取</p>
</li>

<li>
<p>/etc/ppp/ip-up.d/$tunnel</p>
</li>
</ul>

<blockquote>
<h1 id='binbash'>!/bin/bash</h1>

<h2 id='ip'>动态获取原来网关的ip</h2>

<p>gateway=<code>route|grep default|awk &#39;{print $2;}&#39;</code></p>

<h1 id='vpn'>默认从vpn走</h1>

<p>route del default route add default gw $vpn_gateway dev ppp0</p>

<h1 id='vpn'>科大的地址不从vpn走</h1>

<p>route add -net 202.38.0.0/16 gw $gateway dev eth0 route add -net 210.45.0.0/16 gw $gateway dev eth0 route add -net 211.86.0.0/16 gw $gateway dev eth0</p>
</blockquote>

<h3 id='id37'>无线</h3>

<p>- 资料： - <a href='http://moto.debian.org.tw/viewtopic.php?t=7633&amp;amp;start=0&amp;amp;postdays=0&amp;amp;postorder=asc&amp;amp;highlight=&amp;amp;sid=f3a3f4c96593f3a93781d49bcbca4a59'>CentrinoDriver輕鬆編譯</a> - <a href='http://ccl422.blogspot.com/2007/11/wireless.html'>Wireless</a> - <a href='http://www.freebsd.org/cgi/man.cgi?query=wpa_supplicant.conf&amp;amp;sektion=5'>WPA_SUPPLICANT.CONF5</a></p>

<p>- 环境</p>
<table><thead><tr><th>笔记本</th><th>ASUS M2000</th></tr></thead><tbody><tr><td style='text-align: left;'>系统</td><td style='text-align: left;'>Debian 2.6.22-3-686</td>
</tr><tr><td style='text-align: left;'>无线网卡</td><td style='text-align: left;'>Intel Pro/Wireless 2100</td>
</tr><tr><td style='text-align: left;'>ESSID: MyLab</td><td style='text-align: left;'>用户名</td>
</tr><tr><td style='text-align: left;'>MyName</td><td style='text-align: left;'>密码</td>
</tr><tr><td style='text-align: left;'>MyPasswd</td><td style='text-align: left;'>网络验证</td>
</tr><tr><td style='text-align: left;'>WPA</td><td style='text-align: left;'>数据加密</td>
</tr><tr><td style='text-align: left;'>TKIP</td><td style='text-align: left;'>EAP类型</td>
</tr><tr><td style='text-align: left;'>PEAP</td><td style='text-align: left;'>验证方法</td>
</tr><tr><td style='text-align: left;'>EAP-MSCHAP V2</td>
</tr></tbody></table>
<p>- 装驱动</p>

<ul>
<li>
<p>下载<a href='http://ipw2100.sourceforge.net/firmware.php'>ipw2100-fw</a>，解压到/lib/firmware目录下</p>
</li>

<li>
<p>rmmod ipw2100</p>
</li>

<li>
<p>modprobe ipw2100</p>
</li>

<li>
<p>查看/etc/udev/rules.d，找到ipw2100对应的eth1</p>
</li>
</ul>

<blockquote>
<h1 id='pci_device_0x80860x1043_ipw2100'>PCI device 0x8086:0x1043 (ipw2100)</h1>

<p>SUBSYSTEM==&#8221;net&#8221;, DRIVERS==&#8221;?*&#8221;, ATTR{address}==&#8221;xx:xx:xx:xx:xx:xx&#8221;, NAME=&#8221;eth1&#8221;</p>
</blockquote>

<ul>
<li>
<p>找接入的ap：</p>

<ul>
<li>apt-get install wpasupplicant wireless-tools</li>

<li>iwlist eth1 scan</li>
</ul>
</li>

<li>
<p>编辑/etc/wpa_supplicant/lab.conf</p>
</li>
</ul>

<blockquote>
<p>ctrl_interface=/var/run/wpa_supplicant eapol_version=1 ap_scan=1 fast_reauth=1 network={ssid=&#8221;MyLab&#8221; id_str=&#8221;wlab&#8221; scan_ssid=1 key_mgmt=WPA-EAP eap=PEAP identity=&#8221;MyName&#8221; password=&#8221;MyPasswd&#8221; auth_alg=OPEN phase1=&#8221;peaplabel=0&#8221; phase2=&#8221;auth=MSCHAPV2&#8221; priority=10 proto=WPA pairwise=TKIP group=TKIP }</p>
</blockquote>

<p>- 测试一下： <code>wpa_supplicant -w -i eth1 -D wext -c /etc/wpa_supplicant/lab.conf</code></p>

<ul>
<li>编辑/etc/network/interfaces：</li>
</ul>

<blockquote>
<h1 id='id38'>无线网卡</h1>

<p>allow-hotplug eth1 iface eth1 inet dhcp wpa-driver wext wpa-roam /etc/wpa_supplicant/lab.conf</p>

<h3 id='id39'>无线接入实验室</h3>

<p>wpa-ssid &#8220;MyLab&#8221;</p>
</blockquote>

<p>- 启动无线： <code>ifup eth1</code></p>

<h2 id='grub'>grub</h2>

<h3 id='bootgrubmenulst'>/boot/grub/menu.lst</h3>

<blockquote>
<p>title Debian GNU/Linux, kernel 2.6.18-4-686 root (hd0,0) kernel /boot/vmlinuz-2.6.18-4-686 root=/dev/hda1 ro initrd /boot/initrd.img-2.6.18-4-686 savedefault</p>

<p>title Microsoft Windows XP Professional root (hd0,2) savedefault makeactive chainloader +1</p>
</blockquote>

<h3 id='windowslinux'>重装windows后修复linux</h3>

<ul>
<li>作者是msygod@linuxsir，原帖在<a href='http://www.linuxsir.org/bbs/showthread.php?t=180376&amp;highlight=windows'>这里</a></li>

<li>下载<strong>grub for dos</strong>，将其中的grldr拷到c:\</li>

<li><strong>notepad c:\boot.ini</strong>，添加后面一行，<code>c:\grldr=&quot;grub&quot;</code></li>

<li>重启，菜单里面选grub，按&#8221;c&#8221;键，依次打下面的命令(支持tab补全)，X为linux的根分区序号</li>
</ul>

<blockquote>
<p>grub&gt;root (hd0,X) grub&gt;setup (hd0) grub&gt;reboot</p>
</blockquote>

<h3 id='windowsgrub'>无法进入windows，停在grub&gt;处</h3>

<p>Y是windows下C盘所在分区的序号</p>

<blockquote>
<p>grub&gt;rootnoverify (hd0,Y) grub&gt;chainloader +1 grub&gt;boot</p>
</blockquote>

<h3 id='windowsgrub'>无法进入windows，连grub&gt;都看不到</h3>

<ul>
<li>作者是linzi222@linuxsir，原帖在<a href='http://www.linuxsir.org/bbs/archive/index.php/database/t-260082.html'>这里</a></li>

<li>用windows安装盘启动，加载驱动后，按&#8221;R&#8221;键进入故障修复控制台</li>

<li>输入命令__fixboot c:__ - 重启</li>

<li>还不行就试试 <strong>fixmbr</strong></li>
</ul>

<h2 id='id40'>其他</h2>

<h3 id='x'>无法进入X</h3>

<ul>
<li>重启，startx；</li>

<li>dpkg-reconfigure xserver-xorg，startx</li>

<li>提示没权限，则dpkg-reconfigure x11-common，startx</li>
</ul>

<h3 id='framebuffer'>关于framebuffer</h3>

<p>modconf-&gt;kernel-&gt;drivers-&gt;vedio-&gt;vga16fb</p>

<h3 id='id41'>声卡驱动</h3>

<ul>
<li>apt-get install alsa-utils alsa-oss</li>

<li>alsaconf</li>
</ul>

<h3 id='dig'>dig</h3>

<ul>
<li>apt-get install dnsutils</li>
</ul>

<h3 id='apache__mysql__php'>apache + mysql + php</h3>

<ul>
<li><a href='http://wiki.ubuntu.org.cn/Apache%E8%99%9A%E6%8B%9F%E4%B8%BB%E6%9C%BA%E6%8C%87%E5%8D%97'>apache虚拟主机</a></li>

<li><a href='https://wiki.debian.org/zh_CN/LAMP'>lamp配置</a></li>

<li><a href='http://www.duyaofei.com/2012/03/29/vps-%E6%96%B0%E6%89%8B%E6%95%99%E7%A8%8B11%EF%BC%9Adebian-6-%E4%B8%8B-apachemysqlmysql%E7%9A%84lamp%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84%E9%85%8D%E7%BD%AE/'>Debian 6 下 Apache+MySQL+MySQL的LAMP服务器的配置</a></li>
</ul>

<blockquote>
<p>apt-get install apache2 apt-get install mysql-server apt-get install libapache2-mod-php5 php5 php-pear php5-xcache php5-curl apt-get install php5-mysql apt-get install php5-gd apt-get install imagemagick php5-imagick</p>
</blockquote>
  </div>
</div>


      </div>
      <hr>
      <footer>
        <p>&copy; 2014 Pan Lanlan
          with help from <a href="http://jekyllbootstrap.com" target="_blank" title="The Definitive Jekyll Blogging Framework">Jekyll Bootstrap</a>
          and <a href="http://twitter.github.com/bootstrap/" target="_blank">Twitter Bootstrap</a>
        </p>
      </footer>

    </div>

    
  </body>
</html>

